function [hydro_nondim_NMK,phi_i1_NMK,phi_i2_NMK,phi_e_NMK,phi_p_i1_NMK,phi_p_i2_NMK,phi_h_i1_NMK,phi_h_i2_NMK,v_1_r_NMK,v_1_z_NMK,v_2_r_NMK,v_2_z_NMK,v_e_r_NMK,v_e_z_NMK] = hydro_potential_velocity_fields_N3_M3_K3_heaving_both(a1,a2,d1,d2,h,m0,m_k_const1,m_k_const2,m_k_const3,C_1n_1_const1,C_1n_1_const2,C_1n_1_const3,C_1n_1_const4,C_1m_2_const1,C_1m_2_const2,C_1m_2_const3,C_1m_2_const4,C_2m_2_const1,C_2m_2_const2,C_2m_2_const3,C_2m_2_const4,B_k_const1,B_k_const2,B_k_const3,B_k_const4,r,z)
%hydro_potential_velocity_fields_N3_M3_K3_heaving_both
%    [hydro_nondim_NMK,phi_i1_NMK,phi_i2_NMK,phi_e_NMK,phi_p_i1_NMK,phi_p_i2_NMK,phi_h_i1_NMK,phi_h_i2_NMK,v_1_r_NMK,v_1_z_NMK,v_2_r_NMK,v_2_z_NMK,v_e_r_NMK,v_e_z_NMK] = hydro_potential_velocity_fields_N3_M3_K3_heaving_both(A1,A2,D1,D2,H,M0,M_K_CONST1,M_K_CONST2,M_K_CONST3,C_1n_1_const1,C_1n_1_const2,C_1n_1_const3,C_1n_1_const4,C_1m_2_const1,C_1m_2_const2,C_1m_2_const3,C_1m_2_const4,C_2m_2_const1,C_2m_2_const2,C_2m_2_const3,C_2m_2_const4,B_k_const1,B_k_const2,B_k_const3,B_k_const4,R,Z)

%    This function was generated by the Symbolic Math Toolbox version 9.1.
%    21-May-2024 02:43:38

t2 = integral(@(r)-(sqrt(2.0).*C_2m_2_const2.*r.*besselk(0,-(r.*pi)./(d2-h)))./besselk(0,-(a2.*pi)./(d2-h)),a1,a2);
t3 = integral(@(r)(sqrt(2.0).*C_2m_2_const3.*r.*besselk(0,(r.*pi.*-2.0)./(d2-h)))./besselk(0,(a2.*pi.*-2.0)./(d2-h)),a1,a2);
t4 = integral(@(r)-(sqrt(2.0).*C_2m_2_const4.*r.*besselk(0,(r.*pi.*-3.0)./(d2-h)))./besselk(0,(a2.*pi.*-3.0)./(d2-h)),a1,a2);
t5 = log(a1);
t6 = log(a2);
t7 = log(r);
t8 = a2.*m0;
t9 = a2.*m_k_const1;
t10 = a2.*m_k_const2;
t11 = a2.*m_k_const3;
t12 = m0.*r;
t13 = m_k_const1.*r;
t14 = m_k_const2.*r;
t15 = m_k_const3.*r;
t16 = h+z;
t17 = a1.^2;
t18 = a2.^2;
t21 = d1.*2.0;
t22 = d2.*2.0;
t23 = h.*2.0;
t24 = h.^3;
t25 = r.^2;
t26 = z.*2.0;
t31 = 1.0./pi;
t32 = 1.0./a2.^3;
t33 = -h;
t35 = 1.0./h;
t36 = 1.0./m_k_const1;
t37 = 1.0./m_k_const2;
t38 = 1.0./m_k_const3;
t43 = sqrt(2.0);
t53 = C_1n_1_const1./2.0;
t54 = C_1m_2_const1./2.0;
t59 = sqrt(h);
t60 = m0.^(3.0./2.0);
t19 = t17.^2;
t20 = t18.^2;
t27 = m0.*t23;
t28 = m_k_const1.*t23;
t29 = m_k_const2.*t23;
t30 = m_k_const3.*t23;
t34 = -t23;
t39 = m0.*t16;
t40 = m_k_const1.*t16;
t41 = m_k_const2.*t16;
t42 = m_k_const3.*t16;
t44 = besselh(0.0,1,t8);
t45 = besselk(0,t9);
t46 = besselk(0,t10);
t47 = besselk(0,t11);
t48 = besselh(0.0,1,t12);
t49 = t16.^2;
t50 = besselk(0,t13);
t51 = besselk(0,t14);
t52 = besselk(0,t15);
t61 = t6./2.0;
t62 = t7./2.0;
t67 = d1+t33;
t68 = d2+t33;
t69 = t16.*2.0;
t70 = t17./4.0;
t71 = t18./4.0;
t72 = t5-1.0./2.0;
t73 = t6-1.0./2.0;
t74 = t25./2.0;
t89 = C_1m_2_const1.*t17.*(-1.0./4.0);
t55 = sinh(t27);
t56 = sin(t28);
t57 = sin(t29);
t58 = sin(t30);
t63 = cosh(t39);
t64 = cos(t40);
t65 = cos(t41);
t66 = cos(t42);
t75 = -t62;
t76 = -t71;
t77 = -t74;
t78 = C_1n_1_const1.*t70;
t79 = C_1m_2_const1.*t70;
t80 = C_1m_2_const1.*t71;
t81 = t21+t34;
t82 = t22+t34;
t83 = t67.^2;
t84 = t68.^2;
t85 = 1.0./t44;
t86 = 1.0./t45;
t87 = 1.0./t46;
t88 = 1.0./t47;
t90 = a2.^t70;
t91 = 1.0./t67;
t92 = 1.0./t68;
t113 = (t17.*t72)./2.0;
t114 = (t18.*t73)./2.0;
t93 = t27+t55;
t94 = a2.^t76;
t95 = 1.0./t81;
t96 = 1.0./t82;
t97 = r.*t91.*pi;
t98 = r.*t92.*pi;
t99 = a2.*t91.*pi;
t100 = a2.*t92.*pi;
t112 = t49+t77;
t119 = t61+t75;
t120 = t16.*t91.*pi;
t121 = t16.*t92.*pi;
t127 = -t114;
t137 = t69.*t91.*pi;
t139 = t69.*t92.*pi;
t141 = a1.*t91.*pi.*1i;
t142 = a1.*t91.*pi.*2.0i;
t143 = a1.*t92.*pi.*1i;
t144 = a1.*t91.*pi.*3.0i;
t145 = a1.*t92.*pi.*2.0i;
t147 = a1.*t92.*pi.*3.0i;
t170 = (t35.*t36.*t56)./2.0;
t171 = (t35.*t37.*t57)./2.0;
t172 = (t35.*t38.*t58)./2.0;
t101 = t97.*2.0;
t102 = t97.*3.0;
t103 = t98.*2.0;
t104 = t98.*3.0;
t105 = t99.*2.0;
t106 = t99.*3.0;
t107 = t100.*2.0;
t108 = t100.*3.0;
t109 = -t98;
t115 = besseli(0,t99);
t116 = besseli(0,t100);
t117 = besseli(0,t97);
t118 = besseli(0,t98);
t122 = -t100;
t125 = cos(t120);
t126 = cos(t121);
t136 = 1.0./sqrt(t93);
t138 = t120.*3.0;
t140 = t121.*3.0;
t146 = t100.*1i;
t148 = t100.*2.0i;
t149 = t100.*3.0i;
t150 = cos(t137);
t152 = cos(t139);
t157 = C_2m_2_const1.*t119;
t161 = besselj(1,t141);
t162 = besselj(1,t142);
t163 = besselj(1,t143);
t164 = besselj(1,t144);
t165 = besselj(1,t145);
t167 = besselj(1,t147);
t186 = (t19.*t95)./8.0;
t187 = (t19.*t96)./8.0;
t188 = (t20.*t96)./8.0;
t192 = t170+1.0;
t193 = t171+1.0;
t194 = t172+1.0;
t195 = t90.*t94;
t205 = (t17.*t83.*t95)./2.0;
t206 = (t17.*t84.*t96)./2.0;
t207 = (t18.*t84.*t96)./2.0;
t208 = t95.*t112;
t209 = t96.*t112;
t214 = t113+t127;
t110 = -t103;
t111 = -t104;
t123 = -t107;
t124 = -t108;
t128 = besseli(0,t105);
t129 = besseli(0,t106);
t130 = besseli(0,t107);
t131 = besseli(0,t108);
t132 = besseli(0,t101);
t133 = besseli(0,t102);
t134 = besseli(0,t103);
t135 = besseli(0,t104);
t151 = cos(t138);
t153 = cos(t140);
t154 = besselk(0,t122);
t158 = besselk(0,t109);
t166 = besselj(1,t146);
t168 = besselj(1,t148);
t169 = besselj(1,t149);
t173 = 1.0./t115;
t174 = 1.0./t116;
t175 = -t157;
t180 = a1.*t163;
t181 = a1.*t165;
t182 = a1.*t167;
t196 = -t187;
t200 = log(t195);
t202 = 1.0./sqrt(t192);
t203 = 1.0./sqrt(t193);
t204 = 1.0./sqrt(t194);
t210 = -t205;
t211 = -t207;
t212 = -t208;
t213 = -t209;
t216 = (C_2m_2_const1.*t214)./2.0;
t155 = besselk(0,t123);
t156 = besselk(0,t124);
t159 = besselk(0,t110);
t160 = besselk(0,t111);
t176 = 1.0./t128;
t177 = 1.0./t129;
t178 = 1.0./t130;
t179 = 1.0./t131;
t183 = a2.*t166;
t184 = a2.*t168;
t185 = a2.*t169;
t189 = 1.0./t154;
t201 = C_2m_2_const1.*t200;
t215 = C_1m_2_const2.*t118.*t174;
t219 = -t216;
et1 = t79+t187-t188-t201-t206+t207+t216+C_1m_2_const1.*t76+(C_2m_2_const3.*t31.*t43.*t68.*(a1.*besselk(1,a1.*t92.*pi.*-2.0)-a2.*besselk(1,t100.*-2.0)))./(besselk(0,t100.*-2.0).*2.0)-(C_2m_2_const4.*t31.*t43.*t68.*(a1.*besselk(1,a1.*t92.*pi.*-3.0)-a2.*besselk(1,t100.*-3.0)))./(besselk(0,t100.*-3.0).*3.0)-(C_2m_2_const2.*t31.*t43.*t68.*(-a2.*besselk(1,t122)+a1.*besselk(1,-a1.*t92.*pi)))./besselk(0,t122)+(C_1m_2_const2.*t31.*t43.*t68.*(a1.*besselj(1,t143)-a2.*besselj(1,t146)).*1i)./besseli(0,t100)-(C_1m_2_const3.*t31.*t43.*t68.*(a1.*besselj(1,t145)-a2.*besselj(1,t148)).*5.0e-1i)./besseli(0,t107);
et2 = (C_1m_2_const4.*t31.*t43.*t68.*(a1.*besselj(1,t147)-a2.*besselj(1,t149)).*3.333333333333333e-1i)./besseli(0,t108);
if (d2 < h)
    hydro_nondim_NMK = t31.*t32.*(t24.*pi.*(t78+t186+t210+(C_1n_1_const2.*a1.*t31.*t43.*t67.*besselj(1,t141).*1i)./besseli(0,t99)-(C_1n_1_const3.*a1.*t31.*t43.*t67.*besselj(1,t142).*5.0e-1i)./besseli(0,t105)+(C_1n_1_const4.*a1.*t31.*t43.*t67.*besselj(1,t144).*3.333333333333333e-1i)./besseli(0,t106)).*2.0+h.*t23.*t33.*pi.*(et1+et2));
elseif (h <= d2)
    hydro_nondim_NMK = t31.*t32.*(t23.*1.0./t35.^2.*pi.*(t2+t3+t4+t80+t89+t188+t196+t201+t206+t211+t219-(C_1m_2_const2.*t31.*t43.*t68.*(a1.*besselj(1,t143)-a2.*besselj(1,t146)).*1i)./besseli(0,t100)+(C_1m_2_const3.*t31.*t43.*t68.*(a1.*besselj(1,t145)-a2.*besselj(1,t148)).*5.0e-1i)./besseli(0,t107)-(C_1m_2_const4.*t31.*t43.*t68.*(a1.*besselj(1,t147)-a2.*besselj(1,t149)).*3.333333333333333e-1i)./besseli(0,t108))+t23.*1.0./t35.^2.*pi.*(t78+t186+t210+(C_1n_1_const2.*a1.*t31.*t43.*t67.*besselj(1,t141).*1i)./besseli(0,t99)-(C_1n_1_const3.*a1.*t31.*t43.*t67.*besselj(1,t142).*5.0e-1i)./besseli(0,t105)+(C_1n_1_const4.*a1.*t31.*t43.*t67.*besselj(1,t144).*3.333333333333333e-1i)./besseli(0,t106)));
else
    hydro_nondim_NMK = NaN;
end
if nargout > 1
    t226 = C_1n_1_const2.*t43.*t117.*t125.*t173;
    t227 = C_1n_1_const2.*a1.*t31.*t43.*t67.*t161.*t173.*1i;
    t190 = 1.0./t155;
    t191 = 1.0./t156;
    t197 = -t183;
    t198 = -t184;
    t199 = -t185;
    t217 = C_1m_2_const3.*t134.*t178;
    t218 = C_1m_2_const4.*t135.*t179;
    t220 = C_2m_2_const2.*t158.*t189;
    t228 = C_1n_1_const3.*t43.*t132.*t150.*t176;
    t229 = C_1n_1_const4.*t43.*t133.*t151.*t177;
    phi_i1_NMK = t53+t212+t226+t228+t229;
end
if nargout > 2
    t230 = C_1n_1_const3.*a1.*t31.*t43.*t67.*t162.*t176.*5.0e-1i;
    t231 = C_1n_1_const4.*a1.*t31.*t43.*t67.*t164.*t177.*3.333333333333333e-1i;
    t221 = C_2m_2_const3.*t159.*t190;
    t222 = C_2m_2_const4.*t160.*t191;
    t223 = t180+t197;
    t224 = t181+t198;
    t225 = t182+t199;
    t232 = -t230;
    t233 = t215+t220;
    t234 = t217+t221;
    t235 = t218+t222;
    t236 = C_1m_2_const2.*t31.*t43.*t68.*t174.*t223.*1i;
    t238 = C_1m_2_const3.*t31.*t43.*t68.*t178.*t224.*5.0e-1i;
    t239 = C_1m_2_const4.*t31.*t43.*t68.*t179.*t225.*3.333333333333333e-1i;
    t241 = t43.*t126.*t233;
    t244 = t78+t186+t210+t227+t231+t232;
    t237 = -t236;
    t240 = -t239;
    t242 = t43.*t152.*t234;
    t243 = t43.*t153.*t235;
    phi_i2_NMK = t54+t175+t213+t241+t242+t243;
end
if nargout > 3
    phi_e_NMK = B_k_const2.*t43.*t50.*t64.*t86.*t202+B_k_const3.*t43.*t51.*t65.*t87.*t203+B_k_const4.*t43.*t52.*t66.*t88.*t204+B_k_const1.*sqrt(m0).*t48.*t59.*t63.*t85.*t136.*2.0;
end
if nargout > 4
    phi_p_i1_NMK = t212;
end
if nargout > 5
    phi_p_i2_NMK = t213;
end
if nargout > 6
    phi_h_i1_NMK = t53+t226+t228+t229;
end
if nargout > 7
    phi_h_i2_NMK = t54+t175+t241+t242+t243;
end
if nargout > 8
    v_1_r_NMK = r.*t95+C_1n_1_const2.*t43.*t91.*t125.*t173.*pi.*besseli(1,t97)+C_1n_1_const3.*t43.*t91.*t150.*t176.*pi.*besseli(1,t101).*2.0+C_1n_1_const4.*t43.*t91.*t151.*t177.*pi.*besseli(1,t102).*3.0;
end
if nargout > 9
    v_1_z_NMK = t16.*t95.*-2.0-C_1n_1_const2.*t43.*t91.*t117.*t173.*pi.*sin(t120)-C_1n_1_const3.*t43.*t91.*t132.*t176.*pi.*sin(t137).*2.0-C_1n_1_const4.*t43.*t91.*t133.*t177.*pi.*sin(t138).*3.0;
end
if nargout > 10
    v_2_r_NMK = r.*t96+C_2m_2_const1./(r.*2.0)+t43.*t126.*(C_1m_2_const2.*t92.*t174.*pi.*besseli(1,t98)+C_2m_2_const2.*t92.*t189.*pi.*besselk(1,t109))+t43.*t152.*(C_1m_2_const3.*t92.*t178.*pi.*besseli(1,t103).*2.0+C_2m_2_const3.*t92.*t190.*pi.*besselk(1,t110).*2.0)+t43.*t153.*(C_1m_2_const4.*t92.*t179.*pi.*besseli(1,t104).*3.0+C_2m_2_const4.*t92.*t191.*pi.*besselk(1,t111).*3.0);
end
if nargout > 11
    v_2_z_NMK = t16.*t96.*-2.0-t43.*t92.*t233.*pi.*sin(t121)-t43.*t92.*t234.*pi.*sin(t139).*2.0-t43.*t92.*t235.*pi.*sin(t140).*3.0;
end
if nargout > 12
    v_e_r_NMK = -B_k_const2.*m_k_const1.*t43.*t64.*t86.*t202.*besselk(1,t13)-B_k_const3.*m_k_const2.*t43.*t65.*t87.*t203.*besselk(1,t14)-B_k_const4.*m_k_const3.*t43.*t66.*t88.*t204.*besselk(1,t15)-B_k_const1.*t59.*t60.*t63.*t85.*t136.*besselh(1.0,1,t12).*2.0;
end
if nargout > 13
    v_e_z_NMK = -B_k_const2.*m_k_const1.*t43.*t50.*t86.*t202.*sin(t40)-B_k_const3.*m_k_const2.*t43.*t51.*t87.*t203.*sin(t41)-B_k_const4.*m_k_const3.*t43.*t52.*t88.*t204.*sin(t42)+B_k_const1.*t48.*t59.*t60.*t85.*t136.*sinh(t39).*2.0;
end
